trigger: none

pool:
  vmImage: ubuntu-latest

steps:
  - script: |
      echo "Installing jq..."
      sudo apt-get update
      sudo apt-get install -y jq
    displayName: 'Install jq'

  - script: |
      # ========================
      # CONFIGURATION
      # ========================
      ORG="sovereignhousingassociationvsts"
      PROJECT="Enterprise Data Warehouse"  # Use decoded spaces here
      AREA_PATH="Enterprise Data Warehouse\\Data and Analytics"

      EPIC_ID="108342"  # GIS Test epic ID

      FEATURE_TITLE="New Project Name"
      FEATURE_DESC="As per ADO template"

      USER_STORIES=(
        "Story 1 Discovery|Initial background work as needed"
        "Story 2 Scoping|Documented in ADO Feature"
        "Story 3 Report mock-up|Evidenced in PPT or PBI"
        "Story 4 Sourcing data|XL template complete and request raised with Data Engineers"
        "Story 5 Data modelling|XL template complete and request raised with Data Engineers"
        "Story 6 Definitions documented|Word document with sign off from stakeholders. Once agreed, enter into Purview"
        "Story 7 Data validation|Dev dataset back from Data Engineers for initial data checks. Advise when complete"
        "Story 8 DAX measure creation|Master dataset back from Data Engineers for DAX measure creation. Any amendments, notify Data Engineers"
        "Story 9 UAT report build|Build report out from master dataset. Arrange end user testing"
        "Story 10 Sign off|Completion of testing and final sign off"
      )

      echo "Creating Feature: $FEATURE_TITLE"

      read -r -d '' FEATURE_PATCH << EOM
      [
        {"op":"add","path":"/fields/System.Title","value":"$FEATURE_TITLE"},
        {"op":"add","path":"/fields/System.Descri
